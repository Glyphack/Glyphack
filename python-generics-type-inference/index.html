<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=https:/glyphack.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https:/glyphack.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https:/glyphack.com/favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=https:/glyphack.com/android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https:/glyphack.com/apple-touch-icon.png><meta name=description content><title>How to infer type for Generic types in Python? | Glyphack</title><link rel=canonical href=https://glyphack.com/python-generics-type-inference/><meta property="og:url" content="https://glyphack.com/python-generics-type-inference/"><meta property="og:site_name" content="Glyphack"><meta property="og:title" content="How to infer type for Generic types in Python?"><meta property="og:description" content="I implemented Generic classes and functions this week in Enderpy. I’m happy that now my code can now read and infer types of this conformance test.
I chose to skip implementing generics with syntax def f[T](): T because of the scoping behavior. They are also tested extensively in this test case.
Another strange thing I found in the typeshed repo is that in the sys/__init__.py file there is a import sys in the beginning. Making this a cyclic import. I think the reason is to use the sys.version and sys.platform in the type definitions. But in the type checker I manually skip resolving this import because it resolves to itself."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-03-25T16:46:15+01:00"><meta property="article:modified_time" content="2024-03-25T16:46:15+01:00"><link rel=stylesheet href=/assets/combined.min.455b53327434f234e64209735e8469bb37465ce15a3ebc45a1a586dd5e74c673.css media=all><script async defer data-website-id=e8710f0c-a6f2-4d2d-8b95-ef6b66e72226 src=https://cloud.umami.is/script.js></script></head><body class=light><div class=content><header><div class=header><h1 class=header-title><a href=https://glyphack.com/>Glyphack</a></h1><div class=flex><p class=small><a href=/>/Home</a></p><p class=small><a href=/blog/>/Blog</a></p><p class=small><a href=/projects/>/Projects</a></p><p class=small><a href=/now/>/Now</a></p><p class=small><a href=/reading-list/>/Reading List</a></p><p class=small><a href=https://r.glyphack.com/s/s>/Reads This</a></p><p class=small><a href="https://docs.google.com/document/d/1XgC2Va8ZgJ2DrmRKpgd_7iVjv8aASnn8nzl6DgkR1mg/edit?usp=sharing">/Resume</a></p></div></div></header><main class=main><div class=breadcrumbs><a href=/>Home</a><span class=breadcrumbs-separator>/</span><a href=/blog/>Blog</a><span class=breadcrumbs-separator>/</span>
<a href=/python-generics-type-inference/>How to infer type for Generic types in Python?</a></div><div><article><header class=single-intro-container><h1 class=single-title>How to infer type for Generic types in Python?</h1><p class=single-readtime><time datetime=2024-03-25T16:46:15+01:00>March 25, 2024</time></p></header><div class=single-content><p>I implemented Generic classes and functions this week in Enderpy. I&rsquo;m happy that now my code can now read and infer types of <a href=https://github.com/python/typing/blob/main/conformance/tests/generics_basic.py#L114>this conformance test</a>.</p><p>I chose to skip implementing generics with syntax <code>def f[T](): T</code> because of the <a href=https://peps.python.org/pep-0695/#scoping-behavior>scoping behavior</a>.
They are also tested extensively in this <a href=https://github.com/python/typing/blob/main/conformance/tests/generics_syntax_scoping.py>test case</a>.</p><p>Another strange thing I found in the <code>typeshed</code> repo is that in the <code>sys/__init__.py</code> file there is a <code>import sys</code> in the beginning.
Making this a cyclic import. I think the reason is to use the <code>sys.version</code> and <code>sys.platform</code> in the type definitions.
But in the type checker I manually skip resolving this import because it resolves to itself.</p><p>The current implementation I came up with for the generic does not infer the actual type of generic in the type evaluation phase. So if the type checker asks the type of parameter that is generic type it gets back a generic parameter node in the returned type.
I&rsquo;m planning to add the functionality to infer the type of the generic parameter based on the types passed as the generic type to type checker.</p><p>This is how the code works right now:</p><ol><li>The type parameters are inserted in the symbol table like other variables.</li><li>When the type evaluator resolves a type annotation that is referring to typing. TypeVar it considers that a type parameter type.</li><li>When the classes have a base class of <code>typing.Generic[T]</code> the type evaluator tries to find the type parameter, and adds the type parameter to the inferred class type.</li></ol><p>The next step is to continue the generics test cases and implement the type inference for the generic types.</p></div></article><div class=single-pagination><hr><div class=flexnowrap><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/rewrite/>Don't be afraid to Rewrite</a></div></div></div><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text><a href=/best-job/>Best Place to Work at as a Programmer</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>Powered by
<a href=https://gohugo.io/>Hugo</a>
and
<a href=https://github.com/tomfran/typo>tomfran/typo</a></p></footer></body><script src=/js/theme-switch.js></script><script defer src=/js/copy-code.js></script></html>